const resultDetails = {
    "ЛИИ": { link: "types/lii.html" },
    "СЭИ": { link: "types/sei.html" },
    "ЭСЭ": { link: "types/ese.html" },
    "ИЛЭ": { link: "types/ile.html" },
    "ИЭИ": { link: "types/iei.html" },
    "ЛСИ": { link: "types/lsi.html" },
    "СЛЭ": { link: "types/sle.html" },
    "ЭИЭ": { link: "types/eie.html" },
    "ЭСИ": { link: "types/esi.html" },
    "ИЛИ": { link: "types/ili.html" },
    "ЛИЭ": { link: "types/lie.html" },
    "СЭЭ": { link: "types/see.html" },
    "СЛИ": { link: "types/sli.html" },
    "ЭИИ": { link: "types/eii.html" },
    "ИЭЭ": { link: "types/iee.html" },
    "ЛСЭ": { link: "types/lse.html" }
};

const results = Object.keys(resultDetails);

// Hardcoded questions and answers with custom color
const questions = [
    {
        caption: "Экстраверсия - Интроверсия (Позиционность)",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "В фокусе моего внимания мир как он есть, без привязки к своему личному мнению, поэтому обычно я непредвзят и свое мнение меняю легко.", subset: ["ЭСЭ", "ИЛЭ", "СЛЭ", "ЭИЭ", "ЛИЭ", "СЭЭ", "ИЭЭ", "ЛСЭ"] },
            { desc: "В фокусе моего внимания не просто что-то, а в первую очередь то, что это нечто значит лично для меня, поэтому я часто бываю предвзят и субъективен, а мое мнение меняется с трудом.", subset: ["ЛИИ", "СЭИ", "ИЭИ", "ЛСИ", "ЭСИ", "ИЛИ", "СЛИ", "ЭИИ"] },
        ]
    },
    {
        caption: "Сенсорика - Интуиция",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Я хорош когда нужно иметь дело с тем, что можно увидеть или потрогать.", subset: ["СЭИ", "ЭСЭ", "ЛСИ", "СЛЭ", "ЭСИ", "СЭЭ", "СЛИ", "ЛСЭ"] },
            { desc: "Я хорош в решении абстрактных нечетко сформулированных задач.", subset: ["ЛИИ", "ИЛЭ", "ИЭИ", "ЭИЭ", "ИЛИ", "ЛИЭ", "ЭИИ", "ИЭЭ"] },
        ]
    },
    {
        caption: "Этика - Логика",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Я больше думаю про конкретных людей, которые меня окружают. Меня больше занимает вопрос Кто? Если я и думаю о каких-то абстрактных вещах, явлениях и процессах, то все равно удерживаю во внимании вопросы наподобие Кто это сделал? Кому это выгодно? Чего от меня хотят? и т.д.", subset: ["СЭИ", "ЭСЭ", "ИЭИ", "ЭИЭ", "ЭСИ", "СЭЭ", "ЭИИ", "ИЭЭ"] },
            { desc: "Я больше думаю об абстрактных правилах, явлениях и процессах. Меня больше занимает вопрос Что? Если я и думаю о каких-то конкретных людях, то все равно удерживаю во внимании вопросы наподобие К какой группе он относится? Какие у него принципы? Что и как он делает? и т.д.", subset: ["ЛИИ", "ИЛЭ", "ЛСИ", "СЛЭ", "ИЛИ", "ЛИЭ", "СЛИ", "ЛСЭ"] },
        ]
    },
    {
        caption: "Иррациональность - Рациональность",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Мне важно поддерживать свое восприятие целостным, а действия его прерывают, поэтому в своем восприятии я стабилен, а в действиях импульсивен и не люблю долгие повторяющиеся действия.", subset: ["СЭИ", "ИЛЭ", "ИЭИ", "СЛЭ", "ИЛИ", "СЭЭ", "СЛИ", "ИЭЭ"] },
            { desc: "Мне важно, чтобы мои действия были последовательными, а восприятие сбивает с последовательности, поэтому я не люблю отвлекаться на что-то срочное, что нужно немедленно проанализировать и согласовать со своими действиями.", subset: ["ЛИИ", "ЭСЭ", "ЛСИ", "ЭИЭ", "ЭСИ", "ЛИЭ", "ЭИИ", "ЛСЭ"] },
        ]
    },
    {
        caption: "Статика - Динамика",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "В процессе мышления я обычно очерчиваю рамки разумного, важного, за которые не захожу, и далее работаю только внутри них, не отвлекаясь на второстепенное. Между подобными рамками я переключаюсь резко.", subset: ["ЛИИ", "ИЛЭ", "ЛСИ", "СЛЭ", "ЭСИ", "СЭЭ", "ЭИИ", "ИЭЭ"] },
            { desc: "В процессе мышления я обычно не ограничиваю себя, не отбрасываю лишнее, потому что нет ничего лишнего, поэтому он протекает плавно. Если в моем мышлении и возникают какие-то отдельные кадры, то я скорее пролистываю их и сосредоточен на их трансформации и связях, а не на пристальном разглядывании.", subset: ["СЭИ", "ЭСЭ", "ИЭИ", "ЭИЭ", "ИЛИ", "ЛИЭ", "СЛИ", "ЛСЭ"] },
        ]
    },
    {
        caption: "Квестимность - Деклатимность",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Я скорее сам по себе, нежели в команде. Я часто недоволен кем-то или чем-то, указываю на недостатки, критикую и задаю неудобные вопросы.", subset: ["ЛИИ", "ИЛЭ", "ИЭИ", "ЭИЭ", "ЭСИ", "СЭЭ", "СЛИ", "ЛСЭ"] },
            { desc: "Я скорее командный игрок, нежели кот, который гуляет сам по себе. Я больше творец, чем критик. Если кому-то что-то не нравится во мне или в том, что я делаю, это его проблемы.", subset: ["СЭИ", "ЭСЭ", "ЛСИ", "СЛЭ", "ИЛИ", "ЛИЭ", "ЭИИ", "ИЭЭ"] },
        ]
    },
    {
        caption: "Решительность - Рассудительность",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Обычно я уверен в своем восприятии ситуации и обстановки, поэтому не вижу смысла обсуждать свой выбор. Я больше переживаю о том, удастся ли мне реализовать мои планы и достичь своих целей, не помешает ли мне кто-то или что-то, и смогу ли я преодолеть все препятствия на своем пути. Я вполне мог бы даже сходить в храм, чтобы помолиться о важном деле, лишь бы все сложилось успешно.", subset: ["ИЭИ", "ЛСИ", "СЛЭ", "ЭИЭ", "ЭСИ", "ИЛИ", "ЛИЭ", "СЭЭ"] },
            { desc: "Обычно я уверен в своих действиях, поэтому мне не интересно детально обсуждать подробности своего пути к моей цели. В моих действиях нет ничего возвышенного, я не несу крест. Я больше думаю о том, правильно ли я воспринимаю структуру той среды, в которой нахожусь, и является ли моя цель стоящей.", subset: ["ЛИИ", "СЭИ", "ЭСЭ", "ИЛЭ", "СЛИ", "ЭИИ", "ИЭЭ", "ЛСЭ"] },
        ]
    },
    {
        caption: "Веселые - Серьезные",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Я открыт к простому человеческому общению и не испытываю неприязни, когда кто-то делится своими эмоциями или подробностями о личной жизни с окружающими. Я вижу общество как совокупность общающихся друг с другом людей, в котором важнее тот, чье слово остается последним или хотя бы повлияет на как можно большее число людей. Мне неприятно, когда сухой расчет ставят превыше общечеловеческих ценностей.", subset: ["ЛИИ", "СЭИ", "ЭСЭ", "ИЛЭ", "ИЭИ", "ЛСИ", "СЛЭ", "ЭИЭ"] },
            { desc: "Я открыт к участию в совместной трудовой деятельности и испытываю неприязнь, когда эмоции выставляются напоказ. Я вижу общество как совокупность выполняющих свою функцию людей, в котором важнее тот, кто определяет всю цепочку действий или хотя бы может влиять на способ выполнения действий как можно большего числа людей. Мне неприятно, когда из сентиментальных соображений разрушают разумно организованную деятельность.", subset: ["ЭСИ", "ИЛИ", "ЛИЭ", "СЭЭ", "СЛИ", "ЭИИ", "ИЭЭ", "ЛСЭ"] },
        ]
    },
    {
        caption: "Негативизм - Позитивизм",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Мое мышление плавное как симфония.", subset: ["ЛИИ", "СЭИ", "СЛЭ", "ЭИЭ", "ЭСИ", "ИЛИ", "ИЭЭ", "ЛСЭ"] },
            { desc: "Мои мышление парадоксальное как джаз", subset: ["ЭСЭ", "ИЛЭ", "ИЭИ", "ЛСИ", "ЛИЭ", "СЭЭ", "СЛИ", "ЭИИ"] },
        ]
    },
    {
        caption: "Процесс - Результат",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Занимаясь чем-либо привычным, я готов пробовать казалось бы нелогичное, что однако помогает раскрыть новые грани проблемы и расширить область моей деятельности.", subset: ["СЭИ", "ИЛЭ", "ЛСИ", "ЭИЭ", "ИЛИ", "СЭЭ", "ЭИИ", "ЛСЭ"] },
            { desc: "Занимаясь чем-либо привычным, я просто делаю все как обычно, что помогает быстро закрыть вопрос и перейти к следующей проблеме.", subset: ["ЛИИ", "ЭСЭ", "ИЭИ", "СЛЭ", "ЭСИ", "ЛИЭ", "СЛИ", "ИЭЭ"] },
        ]
    },
    {
        caption: "Беспечность - Предусмотрительность",
        color: "#e74a3b",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "У меня есть что-то одно из двух: 1) я быстро загораюсь, бросаю все силы на решение какого-то вопроса (а сил у меня много, так как я экстраверт), а потом перегораю и больше ничего не могу сделать 2) я веду себя настолько разумно, что иногда срываюсь и нарочно совершаю глупости просто потому что уже невыносимо оставаться таким правильным (интровертом).", subset: ["СЭИ", "ИЛЭ", "ЛСИ", "ЭИЭ", "ЭСИ", "ЛИЭ", "СЛИ", "ИЭЭ"] },
            { desc: "Я в недоумении от прочитанного выше.", subset: ["ЛИИ", "ЭСЭ", "ИЭИ", "СЛЭ", "ИЛИ", "СЭЭ", "ЭИИ", "ЛСЭ"] },
        ]
    },
    {
        "caption": "Аристократия - Демократия (как уровень абстракции блока Эго)",
        "color": "#e74a3b",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "Вещи, находящиеся в фокусе моего внимания, и методы, которыми я решаю проблему, обычно не совпадают по критерию абстрактности. Я либо использую абстрактные модели и методы для работы с конкретными вещами и людьми, либо создаю вещи и эмоции / отношения руководствуясь абстрактными принципами.",
                "subset": [
                    "ИЭИ",
                    "СЛЭ",
                    "ЛСИ",
                    "ЭИЭ",
                    "СЛИ",
                    "ИЭЭ",
                    "ЭИИ",
                    "ЛСЭ",
                ]
            },
            {
                "desc": "Вещи, находящиеся в фокусе моего внимания, и методы, которыми я решаю проблему, обычно совпадают по критерию абстрактности. Я занимаюсь либо полностью умозрительными вещами, либо просто полностью погружаюсь в окружающий меня мир вещей и людей.",
                "subset": [
                    "ЛИИ",
                    "ЭСЭ",
                    "СЭИ",
                    "ИЛЭ",
                    "ЭСИ",
                    "ЛИЭ",
                    "ИЛИ",
                    "СЭЭ"
                ]
            }
        ]
    },
    {
        "caption": "Аристократия - Демократия (как транзиентность блока Эго)",
        "color": "#e74a3b",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "И вещи, находящиеся в фокусе моего внимания, и методы, которыми я решаю проблему, совпадают по критерию повторимости. Либо я решаю типовые проблемы типовыми методами, либо нахожу ситуативные решения нестандартных проблем.",
                "subset": [
                    "ИЭИ",
                    "СЛЭ",
                    "ЛСИ",
                    "ЭИЭ",
                    "СЛИ",
                    "ИЭЭ",
                    "ЭИИ",
                    "ЛСЭ",
                ]
            },
            {
                "desc": "Я чаще применяю стандартные методы для решения нестандартных задач, либо часто ищу нестандартные, ситуативные решения повторяющихся задач.",
                "subset": [
                    "ЛИИ",
                    "ЭСЭ",
                    "СЭИ",
                    "ИЛЭ",
                    "ЭСИ",
                    "ЛИЭ",
                    "ИЛИ",
                    "СЭЭ"
                ]
            }
        ]
    },
    {
        "caption": "Эмотивизм - Конструктивизм",
        "color": "#e74a3b",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "В разговоре я сначала устанавливаю эмоциональный контакт, а после этого перехожу к делу.",
                "subset": [
                    "ЛИИ",
                    "ИЭИ",
                    "ЛСИ",
                    "ЛИЭ",
                    "СЭИ",
                    "СЭЭ",
                    "ЛСЭ",
                    "ИЭЭ",
                ]
            },
            {
                "desc": "В разговоре я сразу перехожу к делу, а настраиваюсь на общую эмоциональную волну уже потом.",
                "subset": [
                    "ИЛЭ",
                    "ЭСЭ",
                    "СЛЭ",
                    "ЭИЭ",
                    "ЭСИ",
                    "ИЛИ",
                    "ЭИИ",
                    "СЛИ",
                ]
            }
        ]
    },
    {
        "caption": "Тактика - Стратегия",
        "color": "#e74a3b",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "При поверхностном знакомстве с собеседником я скорее начну разговор с обсуждения окружающей меня обстановки, вещей или личных вкусов, а не идей или сценариев.",
                "subset": [
                    "ЭСЭ",
                    "ИЛЭ",
                    "ЛСИ",
                    "ИЭИ",
                    "ЭСИ",
                    "ИЛИ",
                    "ЛСЭ",
                    "ИЭЭ"
                ]
            },
            {
                "desc": "При поверхностном контакте с собеседником я скорее начну разговор с обсуждения идей, предположений, сценариев, а не вещей.",
                "subset": [
                    "СЭИ",
                    "ЛИИ",
                    "СЛЭ",
                    "ЭИЭ",
                    "СЭЭ",
                    "ЛИЭ",
                    "СЛИ",
                    "ЭИИ",
                ]
            }
        ]
    },
    {
        "caption": "Упрямство - Уступчивость",
        "color": "#e74a3b",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "Моя жизнь - это история борьбы с собственными слабостями.",
                "subset": [ "ЛИИ", "ЭСЭ", "ЛСИ", "ЭИЭ", "ИЛИ", "СЭЭ", "СЛИ", "ИЭЭ" ]
            },
            {
                "desc": "Что?",
                "subset": [ "СЭИ", "ИЛЭ", "ИЭИ", "СЛЭ", "ЭСИ", "ЛИЭ", "ЭИИ", "ЛСЭ" ]
            },
        ]
    },

    {
        caption: "Квадры",
        color: "#16a085",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Мне было бы легко общаться и меня бы приняли в демократичной коллаборативной среде, где можно обсуждать новые идеи, не погружаясь в рутину и в скучные подробности их реализации.", subset: ["ЛИИ", "СЭИ", "ЭСЭ", "ИЛЭ"] },
            { desc: "Мне было бы легко общаться и меня бы приняли в сплоченном коллективе, где глубокая вера в истинность наших общих убеждений позволяет воплощать их в жизнь наперекор всему.", subset: ["ИЭИ", "ЛСИ", "СЛЭ", "ЭИЭ"] },
            { desc: "Мне было бы легко общаться и меня бы приняли в демократичной конкурентной среде, где ценится умение реализовать идею, сделав из нее (то есть из воздуха) нечто разумное, осязаемое и полезное.", subset: ["ЭСИ", "ИЛИ", "ЛИЭ", "СЭЭ"] },
            { desc: "Мне было бы легко общаться и меня бы приняли в сплоченном коллективе, решающем разнообразные практические задачи при помощи уже известных и проверенных методов.", subset: ["СЛИ", "ЭИИ", "ИЭЭ", "ЛСЭ"] },
        ]
    },

    {
        caption: "Первичная Конкретность - Абстрактность",
        color: "#3498db",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "В фокусе моего восприятия конкретные материальные объекты или конкретные люди.", subset: ["СЭИ", "ЭСЭ", "СЛЭ", "ЭИЭ", "ЭСИ", "СЭЭ", "СЛИ", "ЭИИ"] },
            { desc: "В фокусе моего восприятия абстрактные закономерности, правила, последовательности действий, явления, связи, истории, цели и смыслы.", subset: ["ЛИИ", "ИЛЭ", "ИЭИ", "ЛСИ", "ИЛИ", "ЛИЭ", "ИЭЭ", "ЛСЭ"] },
        ]
    },
    {
        "caption": "Первичная Воспроизводимость - Транзиентность",
        "color": "#3498db",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "В фокусе моего восприятия постоянно одно и то же - вещи и концепции, которые я использую снова и снова в точности так, как делал раньше.",
                "subset": [
                    "СЭЭ",
                    "СЛЭ",
                    "СЭИ",
                    "СЛИ",
                    "ЛСЭ",
                    "ЛИЭ",
                    "ЛСИ",
                    "ЛИИ"
                ]
            },
            {
                "desc": "В фокусе моего восприятия каждый раз что-то новое - новые диалоги с (теми же) людьми или новые проявления (все тех же) глобальных концепций.",
                "subset": [
                    "ЭСЭ",
                    "ЭИЭ",
                    "ЭСИ",
                    "ЭИИ",
                    "ИЭЭ",
                    "ИЛЭ",
                    "ИЭИ",
                    "ИЛИ"
                ]
            }
        ]
    },
    {
        "caption": "Вторичная Конкретность - Абстрактность",
        "color": "#3498db",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "Если придется выбирать между красивыми и умными, я буду в лагере красивых. Умею красиво себя преподнести.",
                "subset": [
                    "СЭЭ",
                    "СЭИ",
                    "ЭСЭ",
                    "ЭСИ",
                    "ЛСЭ",
                    "ЛСИ",
                    "ИЭЭ",
                    "ИЭИ"
                ]
            },
            {
                "desc": "Я скорее в лагере умных, чем красивых. Умею оставить о себе такое впечатление.",
                "subset": [
                    "СЛЭ",
                    "СЛИ",
                    "ЭИЭ",
                    "ЭИИ",
                    "ЛИЭ",
                    "ЛИИ",
                    "ИЛЭ",
                    "ИЛИ"
                ]
            }
        ]
    },
    {
        "caption": "Вторичная Воспроизводимость - Транзиентность",
        "color": "#3498db",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "Люблю и умею создавать повторимое: правила, законы, стиль, моду, то есть то, чему все должны следовать и повторять за мной.",
                "subset": [
                    "СЛЭ",
                    "СЛИ",
                    "ЭСЭ",
                    "ЭСИ",
                    "ЛСЭ",
                    "ЛСИ",
                    "ИЛЭ",
                    "ИЛИ"
                ]
            },
            {
                "desc": "Люблю и умею создавать неповторимое: эмоции, настроения, отношение, чаяния, идеи, гипотезы, инсайты, возможности, все то, что до сих пор не поставили на конвейер.",
                "subset": [
                    "СЭЭ",
                    "СЭИ",
                    "ЭИЭ",
                    "ЭИИ",
                    "ЛИЭ",
                    "ЛИИ",
                    "ИЭЭ",
                    "ИЭИ"
                ]
            }
        ]
    },
    {
        "caption": "Альфийство - Гаммийство",
        "color": "#3498db",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "Если я хочу изменений в чем-либо, то подразумеваю, что они должны быть скорыми и существенными.",
                "subset": [
                    "ЛИИ",
                    "ЭСЭ",
                    "ИЛЭ",
                    "СЭИ",
                    "ЭИЭ",
                    "ЛСИ",
                    "ИЭЭ",
                    "СЛИ",
                ]
            },
            {
                "desc": "Если я хочу изменений, то обычно имею в виду постепенную трансформацию.",
                "subset": [
                    "ЛИЭ",
                    "СЭЭ",
                    "ЭСИ",
                    "ИЛИ",
                    "СЛЭ",
                    "ИЭИ",
                    "ЭИИ",
                    "ЛСЭ",
                ]
            }
        ]
    },
    {
        "caption": "Бетанство - Дельтийство",
        "color": "#3498db",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "Когда сталкиваюсь с препятствиями, я склонен упорствовать и продолжать привычные действия.",
                "subset": [
                    "ЭИЭ",
                    "СЛЭ",
                    "ИЭИ",
                    "ЛСИ",
                    "ЛИИ",
                    "ЭСЭ",
                    "СЭЭ",
                    "ИЛИ"
                ]
            },
            {
                "desc": "Когда сталкиваюсь с препятствиями, стараюсь взглянуть на проблему под другим углом.",
                "subset": [
                    "ИЭЭ",
                    "СЛИ",
                    "ЭИИ",
                    "ЛСЭ",
                    "ИЛЭ",
                    "СЭИ",
                    "ЛИЭ",
                    "ЭСИ",
                ]
            }
        ]
    },
    {
        "caption": "Простые - Вычурные",
        "color": "#3498db",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "Меня вряд ли пригласят на бал: я либо интроверт, который любит абстрактные задачи, либо экстраверт, который любит работать с физическими вещами или людьми.",
                "subset": [
                    "ЛИИ",
                    "ЭСЭ",
                    "ИЛИ",
                    "СЭЭ",
                    "ИЭЭ",
                    "СЛИ",
                    "ЭИИ",
                    "ЛСЭ",

                ]
            },
            {
                "desc": "Если они этого не сделают, то многое потеряют: я либо интроверт, который глубоко размышляет об эстетике, красоте и людях, либо экстраверт, который любит интеллектуальные дискуссии.",
                "subset": [
                    "ИЛЭ",
                    "СЭИ",
                    "ИЭИ",
                    "СЛЭ",
                    "ЭИЭ",
                    "ЛСИ",
                    "ЛИЭ",
                    "ЭСИ",
                ]
            }
        ]
    },
    {
        "caption": "Ежи - Лисы",
        "color": "#3498db",
        "answers": [
            { desc: "(Не знаю)", subset: results },
            {
                "desc": "Я верю в то, что говорю, и обычно просто выражаю свое мнение.",
                "subset": [
                    "СЭИ",
                    "ЛИИ",
                    "ИЭИ",
                    "ЭИИ",
                    "ЭСЭ",
                    "ИЛЭ",
                    "СЛЭ",
                    "ЛСЭ",

                ]
            },
            {
                "desc": "Блеф - это прекрасный прием, которым я нередко пользуюсь.",
                "subset": [
                    "ЛСИ",
                    "ЭСИ",
                    "ИЛИ",
                    "СЛИ",
                    "ЭИЭ",
                    "ЛИЭ",
                    "СЭЭ",
                    "ИЭЭ",
                ]
            }
        ]
    },

    {
        caption: "Базовый стиль коммуникации",
        color: "#fd7e14",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Мой основной стиль общения можно назвать скептическим. Мне свойственно критиковать и подвергать сомнению целесообразность и разумность каких-либо действий.", subset: ["ЛИИ", "ЭСИ"] },
            { desc: "Мой основной стиль общения можно назвать отчаянным. Мне свойственно заряжать уверенностью в успехе какого-либо действия, подталкивая к нему моих последователей.", subset: ["ЭСЭ", "ЛИЭ"] },
            { desc: "Мой основной стиль общения можно назвать деликатным. Мне свойственно поддерживать позитивную атмосферу уважительного диалога равных и достойных.", subset: ["СЭИ", "ИЛИ"] },
            { desc: "Мой основной стиль общения можно назвать наглым. Мне свойственно общаться так, словно мне позволено все. И я имею право высказать все, что считаю нужным!", subset: ["ИЛЭ", "СЭЭ"] },
            { desc: "Мой основной стиль общения можно назвать озабоченным. Мне свойственно указывать другим на возможные проблемы в будущем, предусмотрительно предостерегая о возможных трудностях.", subset: ["ИЭИ", "СЛИ"] },
            { desc: "Мой основной стиль общения можно назвать беспечным. Мне свойственно заявлять, что нужно успеть все, все попробовать и насладиться всеми радостями жизни.", subset: ["СЛЭ", "ИЭЭ"] },
            { desc: "Мой основной стиль общения можно назвать отстраненным. Мне свойственно держать дистанцию и советовать другим тоже держаться подальше от разных сомнительных личностей.", subset: ["ЛСИ", "ЭИИ"] },
            { desc: "Мой основной стиль общения можно назвать назойливым. Мне свойственно поймать какую-нибудь бестолочь и пилить, пилить, пилить, пока она не сдастся и не сделает то, что я считаю нужным.", subset: ["ЭИЭ", "ЛСЭ"] },
        ]
    },
    {
        caption: "Творческий стиль коммуникации",
        color: "#fd7e14",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Когда мне нужно донести какую-то важную мысль до собеседника, мой стиль общения становится отчаянным.", subset: ["ЛИИ", "ЭСИ"] },
            { desc: "Когда мне нужно донести какую-то важную мысль до собеседника, мой стиль общения становится скептическим.", subset: ["ЭСЭ", "ЛИЭ"] },
            { desc: "Когда мне нужно донести какую-то важную мысль до собеседника, мой стиль общения становится наглым.", subset: ["СЭИ", "ИЛИ"] },
            { desc: "Когда мне нужно донести какую-то важную мысль до собеседника, мой стиль общения становится деликатным.", subset: ["ИЛЭ", "СЭЭ"] },
            { desc: "Когда мне нужно донести какую-то важную мысль до собеседника, мой стиль общения становится беспечным.", subset: ["ИЭИ", "СЛИ"] },
            { desc: "Когда мне нужно донести какую-то важную мысль до собеседника, мой стиль общения становится озабоченным.", subset: ["СЛЭ", "ИЭЭ"] },
            { desc: "Когда мне нужно донести какую-то важную мысль до собеседника, мой стиль общения становится назойливым.", subset: ["ЛСИ", "ЭИИ"] },
            { desc: "Когда мне нужно донести какую-то важную мысль до собеседника, мой стиль общения становится отстраненным.", subset: ["ЭИЭ", "ЛСЭ"] },
        ]
    },
    {
        caption: "Суггестивный стиль коммуникации",
        color: "#fd7e14",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Я невольно обращу внимание, если что-то высказано в отстраненном стиле.", subset: ["ЛИИ", "ЭСИ"] },
            { desc: "Я невольно обращу внимание, если что-то высказано в назойливом стиле.", subset: ["ЭСЭ", "ЛИЭ"] },
            { desc: "Я невольно обращу внимание, если что-то высказано в озабоченном стиле.", subset: ["СЭИ", "ИЛИ"] },
            { desc: "Я невольно обращу внимание, если что-то высказано в беспечном стиле.", subset: ["ИЛЭ", "СЭЭ"] },
            { desc: "Я невольно обращу внимание, если что-то высказано в деликатном стиле.", subset: ["ИЭИ", "СЛИ"] },
            { desc: "Я невольно обращу внимание, если что-то высказано в наглом стиле.", subset: ["СЛЭ", "ИЭЭ"] },
            { desc: "Я невольно обращу внимание, если что-то высказано в скептическом стиле.", subset: ["ЛСИ", "ЭИИ"] },
            { desc: "Я невольно обращу внимание, если что-то высказано в отчаянном стиле.", subset: ["ЭИЭ", "ЛСЭ"] },
        ]
    },
    {
        caption: "Активационный стиль коммуникации",
        color: "#fd7e14",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "В коллективе, который я курирую, почему-то устанавливается наглый стиль коммуникации.", subset: ["ЛИИ", "ЭСИ"] },
            { desc: "В коллективе, который я курирую, почему-то устанавливается деликатный стиль коммуникации.", subset: ["ЭСЭ", "ЛИЭ"] },
            { desc: "В коллективе, который я курирую, почему-то устанавливается отчаянный стиль коммуникации.", subset: ["СЭИ", "ИЛИ"] },
            { desc: "В коллективе, который я курирую, почему-то устанавливается скептический стиль коммуникации.", subset: ["ИЛЭ", "СЭЭ"] },
            { desc: "В коллективе, который я курирую, почему-то устанавливается назойливый стиль коммуникации.", subset: ["ИЭИ", "СЛИ"] },
            { desc: "В коллективе, который я курирую, почему-то устанавливается отстраненный стиль коммуникации.", subset: ["СЛЭ", "ИЭЭ"] },
            { desc: "В коллективе, который я курирую, почему-то устанавливается беспечный стиль коммуникации.", subset: ["ЛСИ", "ЭИИ"] },
            { desc: "В коллективе, который я курирую, почему-то устанавливается озабоченный стиль коммуникации.", subset: ["ЭИЭ", "ЛСЭ"] },
        ]
    },
    {
        caption: "Болевой стиль коммуникации",
        color: "#fd7e14",
        answers: [
            { desc: "(Не знаю)", subset: results },
            { desc: "Невозможно представить, чтобы я общался в назойливом стиле.", subset: ["ЛИИ", "ЭСИ"] },
            { desc: "Невозможно представить, чтобы я общался в отстраненном стиле.", subset: ["ЭСЭ", "ЛИЭ"] },
            { desc: "Невозможно представить, чтобы я общался в беспечном стиле.", subset: ["СЭИ", "ИЛИ"] },
            { desc: "Невозможно представить, чтобы я общался в озабоченном стиле.", subset: ["ИЛЭ", "СЭЭ"] },
            { desc: "Невозможно представить, чтобы я общался в наглом стиле.", subset: ["ИЭИ", "СЛИ"] },
            { desc: "Невозможно представить, чтобы я общался в деликатном стиле.", subset: ["СЛЭ", "ИЭЭ"] },
            { desc: "Невозможно представить, чтобы я общался в отчаянном стиле.", subset: ["ЛСИ", "ЭИИ"] },
            { desc: "Невозможно представить, чтобы я общался в скептическом стиле.", subset: ["ЭИЭ", "ЛСЭ"] },
        ]
    },
];

// State: selected answer index for each question
let selectedAnswers = Array(questions.length).fill(0);
let currentResults = [...results];

function renderQuestions() {
    $('#questions').empty();
    questions.forEach((q, qi) => {
        const section = $('<div class="question-section"></div>');
        section.append(`<div class="question-color-bar" style="background:${q.color}"></div>`);
        section.append(`<h5>${q.caption}</h5>`);
        q.answers.forEach((a, ai) => {
            const answerId = `q${qi}_a${ai}`;
            const checked = selectedAnswers[qi] === ai ? 'checked' : '';
            const labelClass = ai === 0 ? 'form-check-label default-answer' : 'form-check-label';
            const radioClass = ai === 0 ? 'form-check-input default-radio' : 'form-check-input';
            section.append(`
                    <div class="form-check${ai === 0 ? ' default-radio' : ''}">
                        <input class="${radioClass}" type="radio" name="q${qi}" id="${answerId}" value="${ai}" ${checked}>
                        <label class="${labelClass}" for="${answerId}">
                            ${a.desc}
                        </label>
                        <span class="answer-subset">
                            <i class="bi bi-arrow-return-right"></i>
                            ${a.subset.length === results.length ? 'All types' : a.subset.join(', ')}
                        </span>
                    </div>
                `);
        });
        $('#questions').append(section);
    });
}

function updateResultsAndSyncAnswers() {
    let subset = [...results];
    selectedAnswers.forEach((ai, qi) => {
        subset = subset.filter(r => questions[qi].answers[ai].subset.includes(r));
    });
    currentResults = subset;
    $('#results').html(currentResults.length ? currentResults.map(r =>
        `<a href="${resultDetails[r].link}" title="${resultDetails[r].name}" style="color:#0d6efd;text-decoration:none;display:block;padding:3px 8px;border-radius:4px" onmouseover="this.style.backgroundColor='rgba(13,110,253,0.1)'" onmouseout="this.style.backgroundColor='transparent'">${r}</a>`
    ).join('') : 'No matching types');

    let changed = false;
    questions.forEach((q, qi) => {
        if (selectedAnswers[qi] !== 0) return;

        let found = false;
        for (let ai = 1; ai < q.answers.length; ai++) {
            const a = q.answers[ai];
            if (currentResults.every(r => a.subset.includes(r))) {
                if (selectedAnswers[qi] !== ai) {
                    selectedAnswers[qi] = ai;
                    changed = true;
                }
                found = true;
                break;
            }
        }
        if (!found && selectedAnswers[qi] !== 0) {
            selectedAnswers[qi] = 0;
            changed = true;
        }
    });

    if (changed) {
        renderQuestions();
    }
}

// Initialize when DOM is ready
$(document).ready(function() {
    // Initial render
    renderQuestions();
    $('#results').html(currentResults.map(r =>
        `<a href="${resultDetails[r].link}" title="${resultDetails[r].name}" style="color:#0d6efd;text-decoration:none;display:block;padding:3px 8px;border-radius:4px" onmouseover="this.style.backgroundColor='rgba(13,110,253,0.1)'" onmouseout="this.style.backgroundColor='transparent'">${r}</a>`
    ).join(''));

    // Handle answer selection
    $(document).on('change', '.form-check-input', function () {
        const name = $(this).attr('name');
        const qi = parseInt(name.substring(1));
        const ai = parseInt($(this).val());
        selectedAnswers[qi] = ai;

        let possibleTypes = [...results];
        selectedAnswers.forEach((selAi, selQi) => {
            possibleTypes = possibleTypes.filter(r => questions[selQi].answers[selAi].subset.includes(r));
        });

        if (possibleTypes.length === 0) {
            possibleTypes = questions[qi].answers[ai].subset.slice();
        }

        questions.forEach((q, idx) => {
            let found = false;
            for (let aj = 1; aj < q.answers.length; aj++) {
                if (possibleTypes.every(t => q.answers[aj].subset.includes(t))) {
                    if (selectedAnswers[idx] !== aj) {
                        selectedAnswers[idx] = aj;
                    }
                    found = true;
                    break;
                }
            }
            if (!found && selectedAnswers[idx] !== 0) {
                selectedAnswers[idx] = 0;
            }
        });

        currentResults = possibleTypes;
        $('#results').html(currentResults.length ? currentResults.map(r =>
            `<a href="${resultDetails[r].link}" title="${resultDetails[r].name}" style="color:#0d6efd;text-decoration:none;display:block;padding:3px 8px;border-radius:4px" onmouseover="this.style.backgroundColor='rgba(13,110,253,0.1)'" onmouseout="this.style.backgroundColor='transparent'">${r}</a>`
        ).join('') : 'No matching types');
        renderQuestions();
    });

    // Reset button
    $('#resetBtn').click(function () {
        selectedAnswers = Array(questions.length).fill(0);
        currentResults = [...results];
        renderQuestions();
        $('#results').html(currentResults.map(r =>
            `<a href="${resultDetails[r].link}" title="${resultDetails[r].name}" style="color:#0d6efd;text-decoration:none;display:block;padding:3px 8px;border-radius:4px" onmouseover="this.style.backgroundColor='rgba(13,110,253,0.1)'" onmouseout="this.style.backgroundColor='transparent'">${r}</a>`
        ).join(''));
    });
});
